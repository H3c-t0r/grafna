---
aliases:
  - /docs/grafana/latest/auth/secretscan/
  - /docs/grafana/latest/setup-grafana/configure-security/secretscan/
description: Detect and revoke leaked Grafana service account tokens
title: Configure Grafana secret scanning
menuTitle: Configure secret scanning
weight: 1000
---

# Configure Grafana secret scanning

With Grafana, you can use the GitHub Secret Scanning service to determine if your [service account tokens]({{< relref "../../administration/service-accounts/" >}}) have been leaked on GitHub.

<div class="clearfix"></div>


When GitHub Secret Scanning detects a Grafana secret, its hash is stored in Grafana's secret scanning service.

Grafana instances, whether on-premises or on the cloud, can use this service to verify if a token generated by the instance has been made public. This verification is done by comparing the token's hash with the exposed token's hash.

If the service detects a leaked token, it immediately revokes it, making it useless.

> **Note:** If the `revoke` option is disabled, the service only sends a notification to the configured webhook URL and logs the event. The token is not automatically revoked.


By default, when the Grafana secret scanning service detects a leaked token, the service automatically revokes the token and logs the event.
Additionally, the service can be configured to send an outgoing webhook notification to a webhook URL.

The notification includes a JSON payload that contains the following data:

```json
{
  "alert_uid": "c9ce50a1-d66b-45e4-9b5d-175766cfc026",
  "link_to_upstream_details": <URL to token leak>,
  "message": "Token of type grafana_service_account_token with name
sa-the-toucans has been publicly exposed in <URL to token leak>.
Grafana has revoked this token",
  "state": "alerting",
  "title": "SecretScan Alert: Grafana Token leaked"
}
```

## Steps

> The secretscan feature is disabled by default.

To configure Grafana secret scanning, complete the following steps:

```ini
[secretscan]
# Enable secretscan feature
enabled = false

# Interval to check for token leaks
interval = 5m

# base URL of the grafana token secret check service
base_url = https://secret-scanning.grafana.net

# URL to send outgoing webhooks to in case of detection
oncall_url =

# Whether to revoke the token if a leak is detected or just send a notification
revoke = true
```
