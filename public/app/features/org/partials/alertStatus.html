<topnav title="告警管理" icon="fa fa-fw fa-bell" subnav="true">
  <ul class="nav">
    <li><a href="alerts">总览</a></li>
    <li><a href="alerts/new">新建报警规则</a></li>
    <li class="active"><a href="alerts/status" style="color:red" ng-if="dashboard.rows.length > 0">状态</a></li>
    <li class="active"><a href="alerts/status" ng-if="dashboard.rows.length === 0">状态</a></li>
  </ul>
</topnav>

<div class="page-container">
    <div class="page">
      <h2>告警指标状态</h2>

      <div ng-if="alertRows.length === 0">
        <em>系统一切正常</em>
      </div>
      <table class="grafana-options-table" ng-if="alertRows.length > 0">
        <tr>
          <td><strong>名称</strong></td>
          <td><strong>报警范围</strong></td>
          <td><strong>报警指标</strong></td>
          <td><strong>报警阈值</strong></td>
          <td><string>报警级别</string></td>
          <td></td>
          <td></td>
        </tr>
        <tr ng-repeat="alertDetail in alertRows">
          <td style="width:40%">
            <i class="fa fa-bell"></i> &nbsp;
            {{alertDetail.definition.name}}
          </td>
          <td style="width:40%">
            {{alertDetail.status.monitoredEntity}}
          </td>
          <td style="width:40%">
            {{alertDetail.metric}}
          </td>
          <td style="width:40%">
            {{alertDetail.definition.alertDetails.crit.threshold}}
          </td>
          <td style="width:40%">
            {{alertDetail.status.level}}
          </td>
          <td style="width: 10%">
            <a href="/alerts/association/{{alertDetail.metric}}/{{alertDetail.status.monitoredEntity}}/{{correlationThreshold}}" class="btn btn-mini btn-primary">
              <i class="fa fa-signal"></i>
              相关联指标
            </a>
          </td>
          <td style="width: 10%">
            <a href="http://localhost:5601/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:'{{alertDetail.status.levelChangedTimeStr}}',mode:quick,to:now))&_a=(columns:!(message,type,host),index:'logstash-*',interval:auto,query:(query_string:(analyze_wildcard:!t,query:'*')),sort:!('@timestamp',desc))&indexPattern=logstash-*&type=histogram"
               class="btn btn-mini btn-primary"  target="_blank">
              <i class="fa fa-edit"></i>
              相关日志分析
            </a>
          </td>
        </tr>
      </table>

    </div>

</div>
